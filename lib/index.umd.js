!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).firework=e()}(this,(function(){"use strict";class t{constructor(){this.queue=[]}add(t){return this.queue.push(new a(t)),this}play(){this.queue.forEach((t=>t.play()))}}const e={targets:void 0,duration:1/0,easing:"linear",update:void 0};const s=(()=>{const t={linear:()=>t=>t},e={Sine:()=>t=>1-Math.cos(t*Math.PI/2),Expo:()=>t=>t?Math.pow(2,10*t-10):0,Circ:()=>t=>1-Math.sqrt(1-t*t),Back:()=>t=>t*t*(3*t-2),Bounce:()=>t=>{let e,s=4;for(;t<((e=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((3*e-2)/22-t,2)}};return["Quad","Cubic","Quart","Quint"].forEach(((t,s)=>{e[t]=()=>t=>Math.pow(t,s+2)})),Object.keys(e).forEach((s=>{const i=e[s];t["easeIn"+s]=i,t["easeOut"+s]=()=>t=>1-i()(1-t),t["easeInOut"+s]=()=>t=>t<.5?i()(2*t)/2:1-i()(-2*t+2)/2,t["easeOutIn"+s]=()=>t=>t<.5?(1-i()(1-2*t))/2:(i()(2*t-1)+1)/2})),t})(),i=(t,e,s,i,a,n=!1)=>{t[a]=n?i:(i-e)*s+e};class a{constructor(t=e){t={...e,...t};const{targets:s,duration:i,easing:a,update:n,...o}=t;this.targets=s,this.duration=i,this.easing=a,this.update=n,this.dest=o||{},this.tl=null,this.isPlay=!1}timeline(){return this.tl||(this.tl=new t),this.tl}play(){this.isPlay||(this.isPlay=!0,(t=>{const e=Date.now(),a=e+t.duration,n=t.targets?Array.isArray(t.targets)?t.targets:[t.targets]:[],o=n.map((e=>{const s={};for(const i in t.dest)s[i]=e[i];return s})),r=(a,r,l=!1)=>{n.forEach(((n,h)=>{Object.keys(t.dest).forEach((c=>{const d=parseFloat(o[h][c]);let u=t.dest[c];if("object"==typeof u){if(!Array.isArray(u)){const{value:a,duration:o,easing:h=t.easing}=u,p=s[h]()((r-e)/o);r<=e+o?i(n,d,p,a,c):l&&i(n,d,p,a,c,l)}}else"function"==typeof u&&(u=u(n,h)),i(n,d,a,u,c,l)}))}))},l=()=>{var i;const o=Date.now();o>a?(r(1,o,!0),t.isPlay=!1):(o>=e&&(r(s[t.easing]()((o-e)/t.duration),o),null===(i=t.update)||void 0===i||i.call(t,n)),requestAnimationFrame(l))};l()})(this))}}const n=t=>new a(t);n.random=(t,e)=>Math.floor(Math.random()*(e-t+1))+t;const o=t=>Array.isArray(t)?n.random(t[0],t[1]):t,r=t=>(Array.isArray(t)?t:[t,t]).map((t=>100*t));class l{constructor(t,e,s,i,a){if(this.target={},this.ctx=t,this.x=e,this.y=s,this.color=i,this.color.startsWith("var(")){const[,t]=this.color.match(/var\((--[^)]+)\)/)||[];t&&(this.color=getComputedStyle(document.documentElement).getPropertyValue(t).trim()||this.color)}this.radius=a.radius,this.alpha=a.alpha,this.lineWidth=a.lineWidth,this.rotation=0}draw(){const{ctx:t,x:e,y:s}=this;t.save(),t.translate(e,s),t.rotate(this.rotation*(Math.PI/180)),t.globalAlpha=this.alpha,this.paint(),this.lineWidth?(t.lineWidth=this.lineWidth,t.strokeStyle=this.color,t.stroke()):(t.fillStyle=this.color,t.fill()),t.globalAlpha=1,t.restore()}}const h={circle:class extends l{paint(){const{ctx:t}=this;t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI),t.closePath()}},polygon:class extends l{constructor(t,e,s,i,a){super(t,e,s,i,a),this.sides=o(a.sides)}paint(){const{ctx:t,sides:e,radius:s}=this;t.beginPath(),t.moveTo(s*Math.cos(0),s*Math.sin(0));for(let i=1;i<=e;i++){const a=2*i*Math.PI/e;t.lineTo(s*Math.cos(a),s*Math.sin(a))}t.closePath()}},star:class extends l{constructor(t,e,s,i,a){super(t,e,s,i,a),this.spikes=o(a.spikes)}paint(){const{ctx:t,spikes:e,radius:s}=this;t.beginPath(),t.moveTo(0,-s);for(let i=0;i<2*e;i++){const a=i*Math.PI/e-Math.PI/2,n=i%2==0?s:.5*s,o=Math.cos(a)*n,r=Math.sin(a)*n;t.lineTo(o,r)}t.closePath()}}},c=(t,e,s,i)=>{const a=h[i.shape],{shapeOptions:l,colors:c,number:d}=i;let{radius:u=0,alpha:p=1,lineWidth:f=0}=l||{};return Array.from({length:o(d)},(()=>{if(!a)throw new Error(`Entity type "${i.shape}" is not registered.`);const h=new a(t,e,s,c[n.random(0,c.length-1)],{...l,radius:o(u),alpha:o(r(p))/100,lineWidth:o(f)});return((t,e)=>{const s=e.move.indexOf("emit");if(s>=0){const{emitRadius:i=[50,180]}=e.moveOptions[s]||{},a=n.random(0,360)*Math.PI/180,r=(n.random(0,1)?1:-1)*o(i);t.target.x=t.x+r*Math.cos(a),t.target.y=t.y+r*Math.sin(a)}})(h,i),((t,e)=>{const s=e.move.indexOf("rotate");if(s>=0){const{angle:i=[-180,180]}=e.moveOptions[s]||{};t.target.rotation=o(i)}})(h,i),h}))},d=document.createElement("canvas");d.style.cssText="position:fixed;top:0;left:0;pointer-events:none;z-index:9999999",document.body.appendChild(d);const u=d.getContext("2d"),p=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?"touchstart":"click";let f=0,m=0;const g=()=>{if(!u)return;const{clientWidth:t,clientHeight:e}=document.documentElement;d.width=2*t,d.height=2*e,d.style.width=t+"px",d.style.height=e+"px",u.setTransform(1,0,0,1,0,0),u.scale(2,2)},y=t=>{const{alpha:e=0,alphaEasing:s="linear",alphaDuration:i=[600,800]}=t;return{value:o(r(e))/100,easing:s,duration:o(i)}},v=t=>{const{move:e,moveOptions:s}=t,i={};return e.forEach(((t,e)=>{const a=s[e]||{};if("emit"===t){const{radius:t=.1,alphaChange:e=!1}=a;i.x=t=>t.target.x,i.y=t=>t.target.y,i.radius=o(t),e&&(i.alpha=y(a))}else if("diffuse"===t){const{diffuseRadius:t=[80,160],lineWidth:e=0}=a;i.radius=o(t),i.lineWidth=o(e),i.alpha=y(a)}else"rotate"===t&&(i.rotation=t=>t.target.rotation)})),i},x=t=>{for(const e of t)e.draw()},w=n({duration:1/0,update(){u&&u.clearRect(0,0,d.width,d.height)}});let M=null,E=null;const P=t=>{E=t,M&&document.removeEventListener(p,M,!1),M=e=>{t.excludeElements.some((t=>{return s=e.target,i=t,!!(null===(a=s.closest)||void 0===a?void 0:a.call(s,i));var s,i,a}))||(w.play(),(t=>{var e,s;const{clientX:i,clientY:a}=null!==(s=null===(e=t.touches)||void 0===e?void 0:e[0])&&void 0!==s?s:t;f=i,m=a})(e),A(f,m))},document.addEventListener(p,M,!1),g(),window.removeEventListener("resize",g,!1),window.addEventListener("resize",g,!1)},A=(t,e)=>{if(!E||!u)return;const{particles:s}=E,i=n().timeline();s.forEach((s=>{const{move:a,moveOptions:n}=s;s.move=Array.isArray(a)?a:[a],s.moveOptions=n?Array.isArray(n)?n:[n]:[],i.add({targets:c(u,t,e,s),duration:o(s.duration),easing:s.easing||"linear",update:x,...v(s)})})),i.play()},b=t=>{"loading"===document.readyState?window.addEventListener("DOMContentLoaded",(()=>P(t)),{passive:!0}):P(t)};return b.registerEntity=(t,e)=>{h[t]=e},b.BaseEntity=l,b}));
