!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).firework=e()}(this,(function(){"use strict";class t{constructor(){this.queue=[]}add(t){return this.queue.push(new o(t)),this}play(){this.queue.forEach((t=>t.play()))}}const e={targets:null,duration:1/0,easing:"linear",update:null};var n=()=>{const t={linear:()=>t=>t},e={Sine:()=>t=>1-Math.cos(t*Math.PI/2),Circ:()=>t=>1-Math.sqrt(1-t*t),Back:()=>t=>t*t*(3*t-2),Bounce:()=>t=>{let e,n=4;for(;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)}};return["Quad","Cubic","Quart","Quint","Expo"].forEach(((t,n)=>{e[t]=()=>t=>Math.pow(t,n+2)})),Object.keys(e).forEach((n=>{const o=e[n];t["easeIn"+n]=o,t["easeOut"+n]=()=>t=>1-o()(1-t),t["easeInOut"+n]=()=>t=>t<.5?o()(2*t)/2:1-o()(-2*t+2)/2,t["easeOutIn"+n]=()=>t=>t<.5?(1-o()(1-2*t))/2:(o()(2*t-1)+1)/2})),t};class o{constructor(t=e){t=Object.assign({},e,t);const{targets:n,duration:o,easing:i,update:a,...s}=t;this.targets=n,this.duration=o,this.easing=i,this.update=a,this.dest=s||{},this.tl=null,this.isPlay=!1}timeline(){return null===this.tl&&(this.tl=new t),this.tl}play(){this.isPlay||(this.isPlay=!0,(t=>{const e=Date.now(),o=e+t.duration,i=!!t.targets,a=[],s=(t,e,n,o,i,a=!1)=>{t[i]=a?o:(o-e)*n+e},r=(o,i,r=!1)=>{t.targets.forEach(((l,d)=>{Object.keys(t.dest).forEach((u=>{const c=parseFloat(a[d][u]);let h=t.dest[u];if("object"==typeof h)if(Array.isArray(h));else{const{value:a,duration:d,easing:p}=h;i<=e+d?(o=n()[p||t.easing]()((i-e)/d),s(l,c,o,a,u)):r&&s(l,c,o,a,u,r)}else"function"==typeof h&&(h=h(l,d)),s(l,c,o,h,u,r)}))}))},l=()=>{const a=Date.now();if(a>o)return r(1,a,!0),void(t.isPlay=!1);if(a<e)return void requestAnimationFrame(l);const s=n()[t.easing]()((a-e)/t.duration);i&&r(s,a),"function"==typeof t.update&&t.update(t.targets),requestAnimationFrame(l)};(()=>{if(i){Array.isArray(t.targets)||(t.targets=[t.targets]);for(const e of t.targets){const n={};for(const o in t.dest){const i=t.dest[o];Array.isArray(i)||(n[o]=e[o])}a.push(n)}}})(),l()})(this))}}const i=t=>new o(t);i.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};const a=t=>Array.isArray(t)?i.random(t[0],t[1]):t,s=(t,e)=>{e=e.toUpperCase();do{if(null==t)break;if(t.nodeName===e)return!0}while(null!==(t=t.parentNode));return!1},r=document.createElement("canvas");r.style.cssText="position:fixed;top:0;left:0;pointer-events:none;z-index:9999999",document.body.appendChild(r);const l=r.getContext("2d"),d=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?"touchstart":"click";let u=0,c=0;const h=()=>{r.width=2*window.innerWidth,r.height=2*window.innerHeight,r.style.width=window.innerWidth+"px",r.style.height=window.innerHeight+"px",r.getContext("2d").scale(2,2)},p=(t,e)=>{var n;const{move:o}=e;if(o.includes("emit")){const{emitRadius:o=[50,180]}=null!==(n=e.moveOptions)&&void 0!==n?n:{};t.endPos=((t,e)=>{const n=i.random(0,360)*Math.PI/180,o=[-1,1][i.random(0,1)]*e;return{x:t.x+o*Math.cos(n),y:t.y+o*Math.sin(n)}})(t,a(o))}},f=(t,e)=>{var n;const{move:o}=e;if(o.includes("rotate")){const{angle:o=[-180,180]}=null!==(n=e.moveOptions)&&void 0!==n?n:{};t.endRotation=a(o)}},g=t=>{var e,n;const{move:o}=t;let i={};if(o.includes("emit")){const{radius:n=.1,alphaChange:o=!1,alpha:s=0,alphaEasing:r="linear",alphaDuration:l=[600,800]}=null!==(e=t.moveOptions)&&void 0!==e?e:{};let d={};o&&(d={alpha:{value:a(s),easing:r,duration:a(l)}}),i={...i,x:t=>t.endPos.x,y:t=>t.endPos.y,radius:a(n),...d}}else if(o.includes("diffuse")){const{diffuseRadius:e=[80,160],lineWidth:o=0,alpha:s=0,alphaEasing:r="linear",alphaDuration:l=[600,800]}=null!==(n=t.moveOptions)&&void 0!==n?n:{};i={...i,radius:a(e),lineWidth:a(o),alpha:{value:a(s),easing:r,duration:a(l)}}}return o.includes("rotate")&&(i={...i,rotation:t=>t.endRotation}),i},y=(t,e,n)=>{const o=a(n.number),{radius:s,alpha:r=1,lineWidth:d}=n.shapeOptions,u=[];for(let c=0;c<o;c++){const o={x:t,y:e,color:void 0,radius:void 0,endPos:void 0,rotation:0,endRotation:void 0,draw(){l.globalAlpha=o.alpha,l.beginPath(),l.arc(o.x,o.y,o.radius,0,2*Math.PI,!0),d?(l.lineWidth=o.lineWidth,l.strokeStyle=o.color,l.stroke()):(l.fillStyle=o.color,l.fill()),l.globalAlpha=1}};o.color=n.colors[i.random(0,n.colors.length-1)],o.radius=a(s),o.alpha=a(r),d&&(o.lineWidth=a(d)),p(o,n),f(o,n),u.push(o)}return u},v=(t,e,n)=>{const o=a(n.number),{radius:s,alpha:r=1,lineWidth:d}=n.shapeOptions,u=a(n.shapeOptions.spikes),c=[];for(let h=0;h<o;h++){const o={x:t,y:e,color:void 0,radius:void 0,endPos:void 0,rotation:0,endRotation:void 0,draw(){l.save(),l.translate(o.x,o.y),l.rotate(o.rotation*(Math.PI/180)),l.globalAlpha=o.alpha,l.beginPath(),l.moveTo(0,0-o.radius);for(let t=0;t<2*u;t++){const e=t*Math.PI/u-Math.PI/2,n=t%2==0?o.radius:.5*o.radius,i=Math.cos(e)*n,a=Math.sin(e)*n;l.lineTo(i,a)}l.closePath(),d?(l.lineWidth=o.lineWidth,l.strokeStyle=o.color,l.stroke()):(l.fillStyle=o.color,l.fill()),l.globalAlpha=1,l.restore()}};o.color=n.colors[i.random(0,n.colors.length-1)],o.radius=a(s),o.alpha=a(r),d&&(o.lineWidth=a(d)),p(o,n),f(o,n),c.push(o)}return c},m=t=>{for(const e of t)e.draw()},w=i({duration:1/0,update(){l.clearRect(0,0,r.width,r.height)}});let P=null,x=null;const M=t=>{x=t,P&&document.removeEventListener(d,P,!1),P=e=>{for(const n of t.excludeElements)if(s(e.target,n))return;w.play(),(t=>{u=t.clientX||t.touches&&t.touches[0].clientX,c=t.clientY||t.touches&&t.touches[0].clientY})(e),b(u,c)},document.addEventListener(d,P,!1),h(),window.removeEventListener("resize",h,!1),window.addEventListener("resize",h,!1)},b=(t,e)=>{if(!x)return;const{particles:n}=x,o=i().timeline();for(const i of n){const{duration:n,easing:s}=i;let r=[];"circle"===i.shape?r=y(t,e,i):"star"===i.shape&&(r=v(t,e,i));const l=g(i);o.add({targets:r,duration:a(n),easing:s,update:m,...l})}o.play()};return t=>{"loading"===document.readyState?window.addEventListener("DOMContentLoaded",(()=>M(t)),{passive:!0}):M(t)}}));
