<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>mouse-firework</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="mouse-firework">
  <meta name="description" content="mouse-firework">
  <link rel="stylesheet" href="./lib/codemirror.css">
  <link rel="stylesheet" href="./lib/idea.css">
  <link rel="stylesheet" href="./lib/addon/fold/foldgutter.css">
  <link rel="stylesheet" href="./lib/addon/hint/show-hint.css">
  <style>
    body {
      background-color: black;
      margin: 0;
      padding: 0;
    }

    .CodeMirror {
      width: 50vw;
      height: calc(100vh - 90px);
    }

    button {
      width: 50vw;
      height: 40px;
      border: none;
      outline: none;
      cursor: pointer;
      border-radius: 5px;
      background-color: #3498db;
      color: #ffffff;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    button.template {
      background-color: #1f5092;
      margin: 5px 0;
    }

    button:hover {
      background-color: #2980b9;
    }

    button:active {
      background-color: #1f5092;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body>
  <script src="./lib/codemirror.js"></script>
  <script src="./lib/javascript/javascript.js"></script>
  <script src="./lib/addon/fold/foldcode.js"></script>
  <script src="./lib/addon/fold/foldgutter.js"></script>
  <script src="./lib/addon/fold/brace-fold.js"></script>
  <script src="./lib/addon/fold/comment-fold.js"></script>

  <script src="./lib/addon/edit/matchbrackets.js"></script>
  <script src="./lib/addon/edit/closebrackets.js"></script>

  <script src="./lib/addon/hint/show-hint.js"></script>
  <script src="./lib/addon/hint/anyword-hint.js"></script>

  <script src="./lib/addon/comment/comment.js"></script>

  <script src="./lib/index.umd.js"></script>
  <script>
    const defaultOptions = `
{
  "excludeElements": ["a"],
  "particles": [
    {
      "shape": "circle",
      "move": ["emit"],
      "easing": "easeOutExpo",
      "colors": [
        "rgba(255,182,185,.9)",
        "rgba(250,227,217,.9)",
        "rgba(187,222,214,.9)",
        "rgba(138,198,209,.9)"
      ],
      "number": 30,
      "duration": [1200, 1800],
      "shapeOptions": {
        "radius": [16, 32]
      }
    },
    {
      "shape": "star",
      "move": ["diffuse", "rotate"],
      "easing": "easeOutExpo",
      "colors": ["#FFF"],
      "number": 1,
      "duration": [1200, 1800],
      "shapeOptions": {
        "radius": 20,
        "alpha": 0.5,
        "lineWidth": 6,
        "spikes": 5
      }
    }
  ]
}`.trim()

    const templateArray = [
      `
{
  "excludeElements": ["a"],
  "particles": [
    {
      "shape": "circle",
      "move": ["emit"],
      "easing": "easeOutExpo",
      "colors": [
        "rgba(255,182,185,.9)",
        "rgba(250,227,217,.9)",
        "rgba(187,222,214,.9)",
        "rgba(138,198,209,.9)"
      ],
      "number": 30,
      "duration": [1200, 1800],
      "shapeOptions": {
        "radius": [16, 32]
      }
    },
    {
      "shape": "circle",
      "move": ["diffuse"],
      "easing": "easeOutExpo",
      "colors": ["#FFF"],
      "number": 1,
      "duration": [1200, 1800],
      "shapeOptions": {
        "radius": 20,
        "alpha": 0.5,
        "lineWidth": 6
      }
    }
  ]
}
`,
      `
      {
  "excludeElements": ["a"],
  "particles": [
    {
      "shape": "circle",
      "move": ["emit"],
      "easing": "easeOutExpo",
      "colors": [
      "#ff324a", 
      "#31ffa6", 
      "#206eff", 
      "#ffff99"
      ],
      "number": 30,
      "duration": [1200, 1800],
      "shapeOptions": {
        "radius": [16, 32]
      }
    }
  ]
}
`,
      `
{
  "excludeElements": ["a"],
  "particles": [
    {
      "shape": "polygon",
      "move": ["emit", "rotate"],
      "easing": "easeOutExpo",
      "colors": [
      "#ff324a", 
      "#31ffa6", 
      "#206eff", 
      "#ffff99"
      ],
      "number": 30,
      "duration": [1200, 1800],
      "shapeOptions": {
        "radius": [16, 32],
        "sides": 5
      }
    },
    {
      "shape": "polygon",
      "move": ["diffuse","rotate"],
      "easing": "easeOutExpo",
      "colors": ["#FFF"],
      "number": 3,
      "duration": [1200, 1800],
      "shapeOptions": {
        "radius": 20,
        "alpha": 0.5,
        "lineWidth": 6,
        "sides": 5
      }
    }
  ]
}
      `, `
      {
  "excludeElements": ["a"],
  "particles": [
    {
      "shape": "polygon",
      "move": ["diffuse","rotate"],
      "easing": "easeOutExpo",
      "colors": ["#FFF"],
      "number": 1,
      "duration": [1200, 1800],
      "shapeOptions": {
        "radius": 20,
        "alpha": 0.5,
        "lineWidth": 6,
        "sides": 5
      }
    },
    {
      "shape": "star",
      "move": ["diffuse","rotate"],
      "easing": "easeOutExpo",
      "colors": ["#FFF"],
      "number": 1,
      "duration": [1200, 1800],
      "shapeOptions": {
        "radius": 20,
        "alpha": 0.5,
        "lineWidth": 6,
        "spikes": 5
      }
    },
    {
      "shape": "circle",
      "move": ["diffuse","rotate"],
      "easing": "easeOutExpo",
      "colors": ["#FFF"],
      "number": 1,
      "duration": [1200, 1800],
      "shapeOptions": {
        "radius": 20,
        "alpha": 0.5,
        "lineWidth": 6
      }
    }
  ]
}
      `
    ]
    const editor = CodeMirror(document.body, {
      mode: "application/json",
      value: defaultOptions,
      smartIndent: true,
      styleActiveLine: true,
      lineNumbers: true,
      indentUnit: 2,
      gutters: [
        "CodeMirror-linenumbers",
        "CodeMirror-foldgutter",
        "CodeMirror-lint-markers",
      ],
      lint: true,
      matchBrackets: true,
      autoCloseBrackets: true,
      foldGutter: true,
      autoRefresh: true,
      theme: 'idea'
    });
    let value = defaultOptions;
    editor.on('change', cm => {
      value = cm.getValue()
    })
    const chooseTemplate = (number) => {
      if (templateArray[number]) {
        value = templateArray[number].trim()
        editor.setValue(value)
        firework(JSON.parse(value))
      }
    }
    const button = document.createElement('button')
    button.innerHTML = "application options"
    button.onclick = () => {
      try {
        firework(JSON.parse(value))
      } catch (e) {
        console.error(e)
        alert("invalid options!")
      }
    }
    document.querySelector('.CodeMirror').parentNode.appendChild(button)
    const templateDiv = document.createElement('div')
    templateDiv.style = `
      background-color: #fff;
      height: 50px;
      display: flex;
      width: 100vw;
      gap: 5px;
    `
    templateDiv.innerHTML = `
      <button class="template" onclick="chooseTemplate(0)">template 1</button>
      <button class="template" onclick="chooseTemplate(1)">template 2</button>
      <button class="template" onclick="chooseTemplate(2)">template 3</button>
      <button class="template" onclick="chooseTemplate(3)">template 4</button>
    `
    document.querySelector('.CodeMirror').parentNode.appendChild(templateDiv)

  </script>
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?55ca897d064d6eb98df32d62c6984cc0";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>    
</body>

</html>